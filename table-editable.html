<!DOCTYPE html>
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
<title>Table-editable</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=320, height=device-height" />
            <meta name="description" content="Table-editable by Arun Bharath" />
            <meta name="keywords" content= "Table-editable by arun bharath" />
            <meta name="author" content="Arun Bharath">
            <link href="../../images/favicon.png" rel="icon" />
<meta charset="UTF-8">
<!-- CSS Bootstrap & Custom -->
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<style>
[data-edit-input]:hover{ cursor:pointer}
td{width:25%; position:relative;}
.disabled{cursor:not-allowed;}

.dataedit::before{
    content:'';
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1;
    pointer-events: auto;
    -webkit-tap-highlight-color: transparent;
    background: rgba(0,0,0,.288);
    -webkit-transition: background 1s ease-in;
    -ms-transition: background 1s ease-in;
    transition: background 1s ease-in;
}
.dataedit input{position:absolute;z-index:2;    top: 0;
    bottom: 0;
    left: 0;
    right: 0;}
</style>
</head>
<body>
<div class="container">
<h1>Form Editable</h1>
<form data-edit-form>

<table class="table table-responsive table-bordered">
<thead>
<tr>
<td>name</td>
<td>age</td>
<td>designation</td>
<td>message</td>
<tr>
</thead>
<tbody>
<tr>
<td data-edit-input="input[name]">Arun</td>
<td data-edit-input="input[age]">7</td>
<td data-edit-input="input[designation]">ui developer</td>
<td class="disabled">hi this is arun</td>
</tr>
<tr>
<td data-edit-input="input[name]">Vijay</td>
<td data-edit-input="input[age]">27</td>
<td data-edit-input="input[designation]">ui developer</td>
<td class="disabled">hi this is Vijay</td>
</tr>
<tr>
<td data-edit-input="input[name]">Anitha</td>
<td data-edit-input="input[age]">26</td>
<td data-edit-input="input[designation]">ui designer</td>
<td class="disabled">hi this is Anitha</td>
</tr>
<tr>

</tbody>
</table>
<button type="button" data-update="/api/getpost" data-chunk="3"  class="btn btn-primary">Update</button>
</form>
<hr/>
<form data-edit-form>

<table class="table table-responsive table-bordered">
<thead>
<tr>
<td>name</td>
<td>age</td>
<td>designation</td>
<td>message</td>
<tr>
</thead>
<tbody>
<tr>
<td data-edit-input="input[name]">Arun</td>
<td data-edit-input="input[age]">7</td>
<td data-edit-input="input[designation]">ui developer</td>
<td class="disabled">hi this is arun</td>
</tr>
<tr>
<td data-edit-input="input[name]">Vijay</td>
<td data-edit-input="input[age]">27</td>
<td data-edit-input="input[designation]">ui developer</td>
<td class="disabled">hi this is Vijay</td>
</tr>
<tr>
<td data-edit-input="input[name]">Anitha</td>
<td data-edit-input="input[age]">26</td>
<td data-edit-input="input[designation]">ui designer</td>
<td class="disabled">hi this is Anitha</td>
</tr>
<tr>

</tbody>
</table>
<button type="button" data-update="/api/getpost" data-chunk="3" class="btn btn-primary">Update</button>
</form>

<hr/>

<h2>Additional Contribution</h2>
<mark>Special thanks to Mr.vijaya kumar (ui dev rrd).</mark>
<br/>
<p>Phone:- <a href="tel:+91 95242 18875">9524218875</a></p>
</div>

<script>

/*this function is for button click to send ajax-data*/	
function FormButton(){

var obj = this.parentElement.querySelectorAll('*[data-edit-input]');
obj = Array.prototype.slice.call(obj);
var newObj = '';
/*for iterate through number of obj */
for(i=0; i < obj.length; i++){	
 newObj += obj[i].getAttribute('data-edit-input').replace( /(^.*\[|\].*$)/g, '' ) + ':' + obj[i].innerHTML + ',';
}

var StringToArray = newObj.slice(0, -1).split(',');
var t,y,finalObj = '',chunk = Number(this.getAttribute('data-chunk'));
/*for chunk the array*/
for (t=0,y=StringToArray.length; t<y; t+=chunk) {
    finalObj += '{'+StringToArray.slice(t,t+chunk)+'}'+',';
}

ajax(finalObj.slice(0, -1) ,this.getAttribute('data-update'));

}

/*this function is for ajax-call*/	
var ajax = function(ajaxdata,url){

console.log(ajaxdata);

var http = new XMLHttpRequest();

http.open('POST', url, true);

//Send the proper header information along with the request
http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

http.onreadystatechange = function() {//Call a function when the state changes.
    if(http.readyState == 4 && http.status == 200) {
        alert(http.responseText);
    }
	else{console.warn('Unable to get data (or) please use local server.');}
}
http.send(ajaxdata);

};


/*this function is for form data-edit-input selector*/	
var form = document.querySelectorAll('form[data-edit-form]');
form = Array.prototype.slice.call(form);
form.forEach(function(item,index){

document.getElementsByTagName('form')[index].onclick = FormEdit ;
item.querySelector('button').addEventListener('click',FormButton);

});



/*this function is for form edit*/	
function FormEdit(e){

var target = e.target.getAttribute('data-edit-input') || '';

if(target.replace(/\s*\[.*?\]\s*/g, '') == 'input'){
var value = e.target.innerHTML;
e.target.innerHTML = '<div class="dataedit"><input type="text" class="form-control" value="'+value+'"/></div>';

var eventBinder = e.target.getElementsByTagName('input')[0];
eventBinder.focus();
     
eventBinder.addEventListener('blur',function(){
var InputValue = this.value;
(InputValue) ? e.target.innerHTML = InputValue : alert('value must be filled');
});

}

};

</script>
</body>
</html>
